# 用户决策记录

> 文档版本: v1.0
> 创建日期: 2025-02-11
> 记录人: Claude PM

---

## 决策背景

在需求评审过程中，用户对三个关键功能点做出了明确决策，影响 MVP 范围和开发优先级。

---

## 决策 1: 拖拽功能优先级

**决策内容**: 拖拽功能（拖拽排序、跨文件夹移动）在 MVP 阶段实现

**原计划**: P2 优先级，Phase 2 增强功能阶段实现

**调整为**: P0 优先级，Phase 1 核心功能阶段实现

**理由**:
- 用户期望完整的产品体验，拖拽是接口管理工具的基础交互
- 后期补充拖拽功能需要重构已有代码，成本更高
- Apifox 等竞品均包含完整拖拽功能

**影响范围**:
- 前端：需要完整实现 `@dnd-kit` 集成
- 后端：需要支持文件夹/接口的 `parent_id` 更新和排序字段
- 开发周期：Phase 1 增加 2-3 天工作量

**验收标准**:
- [ ] 同级文件夹/接口可拖拽排序
- [ ] 接口可跨文件夹拖拽移动
- [ ] 拖拽过程有视觉反馈（高亮、占位符）
- [ ] 拖拽后数据持久化成功

---

## 决策 2: Pre-request Script 暂不实现

**决策内容**: Pre-request Script（前置脚本）功能第一版不实现

**原计划**: Tab 中预留 Pre-request Script 入口，Phase 1 实现

**调整为**: 完全移除 Pre-request Script Tab，后续有需求再实现

**理由**:
- MVP 阶段核心目标是接口调试和测试用例生成
- JavaScript 沙箱执行环境复杂度高，安全风险大
- 用户当前需求主要围绕基础调试功能

**影响范围**:
- 前端：移除 `PreRequestTab.tsx` 组件
- 后端：无需实现 JS 执行引擎
- 交互：Tab 栏减少一个选项

**后续规划**:
- v1.1 版本考虑引入 Pre-request Script（JavaScript 沙箱）
- 需要时再评估安全性和实现方案

---

## 决策 3: 执行日志按需显示

**决策内容**: 执行日志默认隐藏，用户可点击展开查看

**原计划**: 响应区域固定显示执行日志

**调整为**: 默认隐藏，提供「展开日志」按钮，点击后显示详细日志

**理由**:
- 大多数情况下用户只关心响应结果，不需要看到详细日志
- 减少视觉干扰，提升界面简洁性
- 保留日志功能方便调试问题

**交互设计**:

```
┌─────────────────────────────────────────────────────────────────────┐
│ Response                              [200 OK]    [125ms]  [1.2KB] │
│                                        [▶ 展开日志]              │
├─────────────────────────────────────────────────────────────────────┤
│ [Body] [Headers] [Cookies] [Timeline]                            │
└─────────────────────────────────────────────────────────────────────┘

                        ↓ 点击「展开日志」

┌─────────────────────────────────────────────────────────────────────┐
│ Response                              [200 OK]    [125ms]  [1.2KB] │
│                                        [▼ 收起日志]              │
├─────────────────────────────────────────────────────────────────────┤
│ [Body] [Headers] [Cookies] [Timeline]                            │
├─────────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ 📋 执行日志                                    [收起 ▲]     │ │
│ │ ├─ 14:32:01.234  准备请求                                  │ │
│ │ ├─ 14:32:01.345  替换环境变量: {{token}} → eyJhbGc...       │ │
│ │ ├─ 14:32:01.456  发送请求: GET /api/users                   │ │
│ │ ├─ 14:32:01.567  DNS 解析: 12.3ms                          │ │
│ │ └─ 14:32:01.890  响应接收: 11.2ms (1.2KB)                 │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
```

**实现细节**:
- 使用 React State 控制展开/收起状态
- 日志条目限制最近 50 条，避免性能问题
- 日志类型：info（蓝色）、success（绿色）、warning（黄色）、error（红色）

---

## 影响总结

| 功能 | 原计划 | 调整后 | 影响 |
|------|--------|--------|------|
| 拖拽排序 | P2 | **P0** | Phase 1 工作量 +2-3 天 |
| Pre-request Script | P0 | **移除** | Phase 1 工作量 -1-2 天 |
| 执行日志 | 固定显示 | **按需显示** | UX 改进，工作量不变 |

**净影响**: Phase 1 工作量略微增加（+1-2 天），但产品体验更符合用户期望。

---

## 文档同步

已更新文档：
- ✅ `01_需求文档.md` - 已同步所有决策变更
- ✅ 版本号更新为 v1.1
- ✅ 优先级调整（拖拽 P2 → P0）
- ✅ 移除 Pre-request Script 相关内容
- ✅ 新增执行日志交互设计
- ✅ 新增 §9 用户决策记录章节

---

**记录结束**
